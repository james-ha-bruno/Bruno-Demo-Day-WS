info:
  name: xml2js - inbuilt library
  type: http
  seq: 3

http:
  method: GET
  url: https://httpbin.org/xml
  auth: inherit

runtime:
  scripts:
    - type: tests
      code: |-
        const { parseStringPromise } = require("xml2js");

        test("status is 200", () => {
          expect(res.getStatus()).to.equal(200);
        });

        test("response XML can be parsed with xml2js", () => {
          const body = res.getBody();
          return parseStringPromise(body, { explicitArray: false }).then(parsed => {
            expect(parsed).to.be.an("object");
            expect(parsed).to.have.property("slideshow");
            expect(parsed.slideshow).to.have.property("slide");
          });
        });

settings:
  encodeUrl: true
  timeout: 0
  followRedirects: true
  maxRedirects: 5
